## SFTP Sync Manager

Кросс-платформенное приложение для двусторонней синхронизации директорий по SFTP с веб-интерфейсом (FastAPI + TailwindCSS/DaisyUI), sqlite-хранилищем и автозагрузчиком обновлений.

### Быстрый старт

```bash
python -m venv .venv
.venv\\Scripts\\activate  # Windows
# source .venv/bin/activate  # Linux/macOS
pip install -r requirements.txt
python app.py --port 8000
```

После запуска откройте `http://127.0.0.1:8000`. Первым делом задайте глобальные настройки и добавьте подключение. Если включён автозапуск, активные подключения стартуют автоматически при старте приложения.

### Проверка работы

1. Настройте SSH/SFTP доступ к тестовому серверу.
2. Создайте пару локальных и удалённых файлов и убедитесь в корректной синхронизации/удалениях.
3. Отслеживайте ход операций во вкладке **Logs** и проверяйте `.sftpsyncignore` в корне локальной папки.
4. Убедитесь, что кнопки Start/Stop/Sync Now работают для каждого подключения.

При необходимости можно включить отладочные логи через переменную окружения `UVICORN_LOG_LEVEL=debug`.

### Автообновление

Файл настроек содержит `update_feed` – URL, который должен отдавать JSON вида:

```json
{ "version": "1.2.3", "url": "https://example.com/SFTP-Sync-Manager-1.2.3.exe", "checksum": "sha256:..." }
```

Через интерфейс или контекстное меню трея можно проверить наличие новой версии и выполнить обновление (загрузка, проверка чек-суммы, замена бинарника и рестарт приложения).

### Сборка в один бинарник (PyInstaller)

- **Windows (без консоли):**
  ```bash
  pyinstaller --onefile --noconsole app.py
  ```
- **macOS (GUI):**
  ```bash
  pyinstaller --onefile --windowed app.py
  ```
- **Linux:**
  ```bash
  pyinstaller --onefile app.py
  ```

После сборки скопируйте рядом с бинарником папку `templates` и убедитесь, что PyInstaller включил зависимости (`paramiko`, `pystray`, `watchdog`). Для обновлений через самодельный фид позаботьтесь об HTTPS-сертификате.
